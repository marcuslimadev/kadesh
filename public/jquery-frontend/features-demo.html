<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Funcionalidades JS - Kadesh</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/kadesh/assets/images/favicon.png">
    
    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Animate CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <style>
        body {
            padding-top: 52px;
            background: #f5f7fa;
        }
        
        .demo-section {
            margin-bottom: 2rem;
        }
        
        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            min-width: 20px;
            height: 20px;
            border-radius: 10px;
            background: #f14668;
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5px;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar is-fixed-top is-white" role="navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="/kadesh/jquery-frontend/index.html">
                <img src="/kadesh/assets/images/logo-kaddesh.svg" alt="Kadesh" height="40">
                <span class="ml-2 has-text-weight-bold is-size-5">Kadesh</span>
            </a>
        </div>
        
        <div class="navbar-menu">
            <div class="navbar-start">
                <a class="navbar-item" href="#/auctions">
                    <span class="icon"><i class="fas fa-gavel"></i></span>
                    <span>Leilões</span>
                </a>
                <a class="navbar-item" href="#/watchlist">
                    <span class="icon"><i class="fas fa-star"></i></span>
                    <span>Favoritos</span>
                </a>
            </div>
            
            <div class="navbar-end">
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link" style="position: relative;">
                        <span class="icon"><i class="fas fa-bell"></i></span>
                        <span>Notificações</span>
                        <span id="notificationBadge" class="notification-badge" style="display: none;">0</span>
                    </a>
                    <div class="navbar-dropdown is-right" id="notificationDropdown" style="min-width: 350px; max-height: 400px; overflow-y: auto;">
                        <!-- Notifications will be loaded here -->
                    </div>
                </div>
                
                <div class="navbar-item">
                    <a class="button is-primary" href="#/dashboard">
                        <span class="icon"><i class="fas fa-user"></i></span>
                        <span>Dashboard</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="section">
        <div class="container">
            <h1 class="title is-2 mb-5">
                <span class="icon has-text-primary mr-2">
                    <i class="fas fa-code"></i>
                </span>
                Demo: Funcionalidades JavaScript
            </h1>

            <!-- SPA Router -->
            <div class="demo-section">
                <div class="box">
                    <h2 class="title is-4">
                        <span class="icon has-text-info"><i class="fas fa-route"></i></span>
                        <span>SPA Router</span>
                    </h2>
                    <p class="mb-4">Sistema de roteamento single-page com hash navigation</p>
                    
                    <div class="buttons">
                        <a href="#/auctions" class="button is-info">
                            <span class="icon"><i class="fas fa-gavel"></i></span>
                            <span>Ir para Leilões</span>
                        </a>
                        <a href="#/watchlist" class="button is-warning">
                            <span class="icon"><i class="fas fa-star"></i></span>
                            <span>Ir para Favoritos</span>
                        </a>
                        <a href="#/dashboard" class="button is-success">
                            <span class="icon"><i class="fas fa-chart-line"></i></span>
                            <span>Ir para Dashboard</span>
                        </a>
                        <a href="#/not-found-page" class="button is-danger">
                            <span class="icon"><i class="fas fa-exclamation-triangle"></i></span>
                            <span>Testar 404</span>
                        </a>
                    </div>
                    
                    <div class="notification is-info is-light mt-4">
                        <p><strong>Rota atual:</strong> <code id="currentRoute">#/</code></p>
                        <p><strong>Parâmetros:</strong> <code id="routeParams">{}</code></p>
                    </div>
                    
                    <details class="mt-4">
                        <summary class="has-text-weight-bold mb-2" style="cursor: pointer;">Ver código de exemplo</summary>
                        <div class="code-block">
const router = new SPARouter({
    container: '#app',
    defaultRoute: 'auctions',
    routes: {
        'auctions': { 
            template: '/pages/auctions.html',
            title: 'Leilões Ativos'
        },
        'project/:id': {
            template: '/pages/project-details.html',
            title: 'Detalhes do Projeto',
            requiresAuth: true
        }
    }
});

// Navigate programmatically
router.navigate('project/123');
                        </div>
                    </details>
                </div>
            </div>

            <!-- Watchlist Manager -->
            <div class="demo-section">
                <div class="box">
                    <h2 class="title is-4">
                        <span class="icon has-text-warning"><i class="fas fa-star"></i></span>
                        <span>Watchlist Manager</span>
                    </h2>
                    <p class="mb-4">Sistema de favoritos com persistência local</p>
                    
                    <div class="field has-addons mb-4">
                        <div class="control is-expanded">
                            <input class="input" type="text" id="watchlistProjectId" placeholder="ID do Projeto (ex: 101)">
                        </div>
                        <div class="control">
                            <button class="button is-warning" id="addToWatchlist">
                                <span class="icon"><i class="fas fa-plus"></i></span>
                                <span>Adicionar aos Favoritos</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="notification is-warning is-light">
                        <p><strong>Total de favoritos:</strong> <span id="watchlistCount">0</span></p>
                    </div>
                    
                    <div id="watchlistItems" class="content">
                        <!-- Items will be rendered here -->
                    </div>
                    
                    <div class="buttons">
                        <button class="button is-light is-small" id="clearWatchlist">
                            <span class="icon"><i class="fas fa-trash"></i></span>
                            <span>Limpar Favoritos</span>
                        </button>
                        <button class="button is-light is-small" id="exportWatchlist">
                            <span class="icon"><i class="fas fa-download"></i></span>
                            <span>Exportar JSON</span>
                        </button>
                    </div>
                    
                    <details class="mt-4">
                        <summary class="has-text-weight-bold mb-2" style="cursor: pointer;">Ver código de exemplo</summary>
                        <div class="code-block">
const watchlist = new WatchlistManager();

// Add to watchlist
watchlist.add(projectId, {
    title: 'Reforma Comercial',
    price: 45000,
    category: 'obras'
});

// Toggle
watchlist.toggle(projectId);

// Listen to changes
watchlist.on('added', (project) => {
    console.log('Added:', project);
});
                        </div>
                    </details>
                </div>
            </div>

            <!-- Notification Manager -->
            <div class="demo-section">
                <div class="box">
                    <h2 class="title is-4">
                        <span class="icon has-text-danger"><i class="fas fa-bell"></i></span>
                        <span>Notification Manager</span>
                    </h2>
                    <p class="mb-4">Sistema de notificações toast e persistentes</p>
                    
                    <div class="buttons">
                        <button class="button is-success" id="showSuccessToast">
                            <span class="icon"><i class="fas fa-check"></i></span>
                            <span>Sucesso</span>
                        </button>
                        <button class="button is-info" id="showInfoToast">
                            <span class="icon"><i class="fas fa-info"></i></span>
                            <span>Info</span>
                        </button>
                        <button class="button is-warning" id="showWarningToast">
                            <span class="icon"><i class="fas fa-exclamation-triangle"></i></span>
                            <span>Aviso</span>
                        </button>
                        <button class="button is-danger" id="showErrorToast">
                            <span class="icon"><i class="fas fa-times"></i></span>
                            <span>Erro</span>
                        </button>
                        <button class="button is-primary" id="showPersistentNotification">
                            <span class="icon"><i class="fas fa-bell"></i></span>
                            <span>Persistente</span>
                        </button>
                    </div>
                    
                    <div class="notification is-info is-light mt-4">
                        <p><strong>Notificações não lidas:</strong> <span id="unreadCount">0</span></p>
                        <p class="is-size-7 has-text-grey mt-2">Notificações aparecem no canto superior direito e na navbar</p>
                    </div>
                    
                    <details class="mt-4">
                        <summary class="has-text-weight-bold mb-2" style="cursor: pointer;">Ver código de exemplo</summary>
                        <div class="code-block">
const notifications = new NotificationManager({
    position: 'top-right',
    duration: 5000
});

// Show toast
notifications.success('Lance enviado!');
notifications.error('Erro ao processar');

// Persistent notification
notifications.show('Nova proposta recebida', 'info', 
    'Proposta', { persistent: true });
                        </div>
                    </details>
                </div>
            </div>

            <!-- Integration Demo -->
            <div class="demo-section">
                <div class="box">
                    <h2 class="title is-4">
                        <span class="icon has-text-success"><i class="fas fa-puzzle-piece"></i></span>
                        <span>Integração Completa</span>
                    </h2>
                    <p class="mb-4">Todas as funcionalidades trabalhando juntas</p>
                    
                    <div class="content">
                        <p>Este sistema integra:</p>
                        <ul>
                            <li><strong>SPA Router:</strong> Navegação sem reload</li>
                            <li><strong>Watchlist:</strong> Favoritos sincronizados</li>
                            <li><strong>Notifications:</strong> Feedback visual</li>
                            <li><strong>Responsive Layout:</strong> Mobile-first</li>
                            <li><strong>Filters:</strong> Busca avançada</li>
                            <li><strong>Countdown:</strong> Timers em tempo real</li>
                            <li><strong>Score Calculator:</strong> Ranking ponderado</li>
                        </ul>
                    </div>
                    
                    <div class="buttons">
                        <a href="/kadesh/jquery-frontend/three-column-demo.html" class="button is-primary is-large">
                            <span class="icon"><i class="fas fa-rocket"></i></span>
                            <span>Ver Demo Completo</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <!-- JavaScript Modules -->
    <script src="/kadesh/jquery-frontend/assets/js/spa-router-bulma.js"></script>
    <script src="/kadesh/jquery-frontend/assets/js/watchlist-manager-bulma.js"></script>
    <script src="/kadesh/jquery-frontend/assets/js/notification-manager-bulma.js"></script>
    
    <script>
        $(document).ready(function() {
            // Initialize Notification Manager
            const notifications = new NotificationManager({
                position: 'top-right',
                duration: 5000,
                badgeSelector: '#notificationBadge',
                dropdownSelector: '#notificationDropdown'
            });
            
            // Initialize Watchlist Manager
            const watchlist = new WatchlistManager();
            watchlist.initializeButtons();
            
            // Initialize SPA Router (basic demo)
            const router = new SPARouter({
                container: '#routerContent',
                defaultRoute: 'auctions',
                routes: {
                    'auctions': { title: 'Leilões Ativos' },
                    'watchlist': { title: 'Favoritos' },
                    'dashboard': { title: 'Dashboard' }
                }
            });
            
            // Update route display
            router.afterEach((route, params) => {
                $('#currentRoute').text(window.location.hash || '#/');
                $('#routeParams').text(JSON.stringify(params));
            });
            
            // Toast buttons
            $('#showSuccessToast').on('click', () => {
                notifications.success('Operação realizada com sucesso!', 'Sucesso');
            });
            
            $('#showInfoToast').on('click', () => {
                notifications.info('Esta é uma notificação informativa', 'Informação');
            });
            
            $('#showWarningToast').on('click', () => {
                notifications.warning('Atenção: verifique os dados antes de continuar', 'Atenção');
            });
            
            $('#showErrorToast').on('click', () => {
                notifications.error('Ocorreu um erro ao processar sua solicitação', 'Erro');
            });
            
            $('#showPersistentNotification').on('click', () => {
                notifications.show(
                    'Você recebeu uma nova proposta no projeto #12345',
                    'info',
                    'Nova Proposta',
                    { persistent: true, duration: 3000 }
                );
                updateUnreadCount();
            });
            
            // Watchlist buttons
            $('#addToWatchlist').on('click', () => {
                const projectId = $('#watchlistProjectId').val();
                
                if (!projectId) {
                    notifications.warning('Digite o ID do projeto', 'Atenção');
                    return;
                }
                
                const added = watchlist.add(projectId, {
                    title: `Projeto #${projectId}`,
                    price: Math.floor(Math.random() * 100000) + 10000,
                    category: 'obras'
                });
                
                if (added) {
                    notifications.success(`Projeto #${projectId} adicionado aos favoritos`, 'Sucesso');
                    $('#watchlistProjectId').val('');
                    updateWatchlistDisplay();
                } else {
                    notifications.warning('Projeto já está nos favoritos', 'Atenção');
                }
            });
            
            $('#clearWatchlist').on('click', () => {
                if (confirm('Deseja limpar todos os favoritos?')) {
                    watchlist.clear();
                    notifications.info('Favoritos limpos', 'Info');
                    updateWatchlistDisplay();
                }
            });
            
            $('#exportWatchlist').on('click', () => {
                const json = watchlist.export();
                console.log('Watchlist JSON:', json);
                
                // Download as file
                const blob = new Blob([json], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'kadesh-favoritos.json';
                a.click();
                
                notifications.success('Favoritos exportados', 'Sucesso');
            });
            
            // Listen to watchlist changes
            watchlist.on('changed', () => {
                updateWatchlistDisplay();
            });
            
            // Update displays
            function updateWatchlistDisplay() {
                $('#watchlistCount').text(watchlist.count());
                
                const items = watchlist.getAll();
                const $container = $('#watchlistItems');
                
                if (items.length === 0) {
                    $container.html('<p class="has-text-grey">Nenhum favorito ainda</p>');
                    return;
                }
                
                let html = '<ul>';
                items.forEach(item => {
                    html += `
                        <li>
                            <strong>${item.title}</strong> - 
                            R$ ${item.price.toLocaleString('pt-BR')} 
                            <button class="button is-small is-danger is-light ml-2" onclick="removeFromWatchlist('${item.id}')">
                                <span class="icon is-small"><i class="fas fa-times"></i></span>
                            </button>
                        </li>
                    `;
                });
                html += '</ul>';
                
                $container.html(html);
            }
            
            function updateUnreadCount() {
                $('#unreadCount').text(notifications.getUnreadCount());
            }
            
            // Global function for remove buttons
            window.removeFromWatchlist = function(id) {
                watchlist.remove(id);
                notifications.info('Removido dos favoritos', 'Info');
            };
            
            // Initial update
            updateWatchlistDisplay();
            updateUnreadCount();
            
            // Mobile navbar burger
            $('.navbar-burger').on('click', function() {
                $(this).toggleClass('is-active');
                $('.navbar-menu').toggleClass('is-active');
            });
        });
    </script>
</body>
</html>
