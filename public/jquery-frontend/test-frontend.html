<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Rápido - Kadesh</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .test-result {
            margin-bottom: 10px;
        }
        .success { color: #48c774; }
        .error { color: #f14668; }
    </style>
</head>
<body>
    <div class="container">
        <div class="box">
            <h1 class="title">
                <i class="fas fa-vial"></i> Teste Rápido do Frontend
            </h1>
            
            <div class="content" id="results">
                <p><i class="fas fa-spinner fa-spin"></i> Executando testes...</p>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function() {
            const tests = [];
            
            // Teste 1: Verificar se jQuery está carregado
            tests.push({
                name: 'jQuery carregado',
                pass: typeof jQuery !== 'undefined'
            });
            
            // Teste 2: Verificar se Bulma CSS está carregado
            tests.push({
                name: 'Bulma CSS carregado',
                pass: $('.box').length > 0
            });
            
            // Teste 3: Testar conexão com backend
            let backendOk = false;
            $.ajax({
                url: '/kadesh/api',
                method: 'GET',
                async: false
            }).done(function() {
                backendOk = true;
            });
            
            tests.push({
                name: 'Backend acessível',
                pass: backendOk
            });
            
            // Teste 4: Verificar arquivos JS
            const jsFiles = [
                'config.js',
                'main-bulma.js',
                'auth-bulma.js',
                'projects-bulma.js',
                'auctions-bulma.js',
                'wallet-bulma.js',
                'reputation-bulma.js',
                'notifications-bulma.js'
            ];
            
            jsFiles.forEach(file => {
                let fileExists = false;
                $.ajax({
                    url: '/kadesh/public/jquery-frontend/assets/js/' + file,
                    method: 'HEAD',
                    async: false
                }).done(function() {
                    fileExists = true;
                });
                
                tests.push({
                    name: `Arquivo ${file} existe`,
                    pass: fileExists
                });
            });
            
            // Renderizar resultados
            let html = '<h3 class="subtitle">Resultados:</h3>';
            let totalTests = tests.length;
            let passedTests = 0;
            
            tests.forEach(test => {
                if (test.pass) passedTests++;
                const icon = test.pass ? 
                    '<i class="fas fa-check-circle success"></i>' : 
                    '<i class="fas fa-times-circle error"></i>';
                const className = test.pass ? 'success' : 'error';
                
                html += `<div class="test-result ${className}">${icon} ${test.name}</div>`;
            });
            
            const percentage = ((passedTests / totalTests) * 100).toFixed(1);
            const statusClass = percentage === '100.0' ? 'is-success' : 'is-warning';
            
            html += `
                <hr>
                <div class="notification ${statusClass}">
                    <p class="title is-4">
                        ${passedTests} de ${totalTests} testes passaram (${percentage}%)
                    </p>
                    ${percentage === '100.0' ? 
                        '<p><i class="fas fa-party-horn"></i> Todos os testes passaram! O frontend está pronto.</p>' :
                        '<p><i class="fas fa-exclamation-triangle"></i> Alguns testes falharam. Verifique os arquivos.</p>'
                    }
                </div>
                
                <a href="index.html" class="button is-primary is-large is-fullwidth">
                    <span class="icon"><i class="fas fa-rocket"></i></span>
                    <span>Abrir Sistema Completo</span>
                </a>
            `;
            
            $('#results').html(html);
        });
    </script>
</body>
</html>
