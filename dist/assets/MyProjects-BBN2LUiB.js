import{r as e,c as t,B as a,o,J as r,a as s,e as l,j as d,t as n,C as i,K as c,q as u,F as b,l as p,f as g,h as v,i as m,g as x,b as f,p as h,n as y}from"./vue-NU_yXd1p.js";import{_ as w,u as A}from"./index-BXuC9o97.js";import{_ as k}from"./Pagination-CPcQ3YY2.js";import{p as _}from"./projectService-ByVQH1Y8.js";import"./utils-CeLII1lI.js";const F={class:"min-h-screen bg-page py-8"},j={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},C={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},D={class:"bg-[#161821] rounded-lg shadow-lg p-6 border border-[rgba(212,175,55,0.24)]"},M={class:"flex items-center"},B={class:"text-2xl font-bold text-heading"},V={class:"bg-[#161821] rounded-lg shadow-lg p-6 border border-[rgba(212,175,55,0.24)]"},z={class:"flex items-center"},$={class:"text-2xl font-bold text-heading"},P={class:"bg-[#161821] rounded-lg shadow-lg p-6 border border-[rgba(212,175,55,0.24)]"},E={class:"flex items-center"},N={class:"text-2xl font-bold text-heading"},T={class:"bg-[#161821] rounded-lg shadow-lg p-6 border border-[rgba(212,175,55,0.24)]"},L={class:"flex items-center"},R={class:"text-2xl font-bold text-heading"},S={class:"bg-[#161821] rounded-lg shadow-lg p-6 mb-6 border border-[rgba(212,175,55,0.24)]"},O={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},H=["value"],U={key:0,class:"mt-4"},q={key:0,class:"text-center py-12"},G={key:1,class:"bg-[#161821] rounded-lg shadow-lg p-8 text-center border border-[rgba(212,175,55,0.24)]"},I={class:"mt-2 text-sm text-body"},J={key:2,class:"bg-[#161821] rounded-lg shadow-lg p-12 text-center border border-[rgba(212,175,55,0.24)]"},K={class:"mt-2 text-sm text-body"},W={class:"mt-6"},Q={key:3,class:"space-y-6"},X={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Y={class:"relative h-48 overflow-hidden rounded-t-2xl bg-gradient-to-br from-[#1A1A1A] to-[#0F1117]"},Z=["src","alt"],ee={key:1,class:"w-full h-full flex items-center justify-center"},te={class:"absolute top-3 left-3"},ae={key:2,class:"absolute top-3 right-3"},oe={class:"p-5 bg-[#161821] border-x border-b border-[rgba(212,175,55,0.24)] rounded-b-2xl"},re={class:"inline-block px-3 py-1 bg-[#D4AF37]/10 text-[#D4AF37] text-xs font-semibold rounded-full mb-3"},se={class:"text-xs uppercase tracking-wide text-[#C7C7C7] mb-1"},le={class:"text-[#F5F5F5] font-semibold"},de={class:"text-[#C7C7C7] text-sm line-clamp-2 mb-4"},ne={class:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4 p-3 bg-[#0F1117] rounded-xl"},ie={class:"text-center"},ce={class:"text-base font-bold text-[#D4AF37]"},ue={class:"text-center border-x border-[rgba(212,175,55,0.1)]"},be={class:"text-sm font-semibold text-[#F5F5F5]"},pe={class:"text-center border-x border-[rgba(212,175,55,0.1)] sm:border-x-0 sm:border-l sm:border-[rgba(212,175,55,0.1)]"},ge={class:"text-base font-bold text-[#F5F5F5]"},ve={class:"text-center"},me={class:"flex items-center justify-end gap-2 pt-3 border-t border-[rgba(212,175,55,0.1)]"},xe={key:0,class:"cta-bid"},fe={key:4,class:"mt-8"},he=w({__name:"MyProjects",setup(w){const he=A(),ye=e([]),we=e(!1),Ae=e(null),ke=e(1),_e=t(()=>{var e;return(null==(e=he.user)?void 0:e.name)||"Voce"}),Fe=e({status:"",category:"",sortBy:"created_at_desc"}),je=_.getCategories(),Ce=t(()=>({total:ye.value.length,open:ye.value.filter(e=>"open"===e.status).length,in_progress:ye.value.filter(e=>"in_progress"===e.status).length,completed:ye.value.filter(e=>"completed"===e.status).length})),De=t(()=>""!==Fe.value.status||""!==Fe.value.category),Me=t(()=>{let e=[...ye.value];Fe.value.status&&(e=e.filter(e=>e.status===Fe.value.status)),Fe.value.category&&(e=e.filter(e=>e.category===Fe.value.category)),e.sort((e,t)=>{switch(Fe.value.sortBy){case"created_at_desc":return new Date(t.created_at)-new Date(e.created_at);case"created_at_asc":return new Date(e.created_at)-new Date(t.created_at);case"budget_desc":return(t.budget||0)-(e.budget||0);case"budget_asc":return(e.budget||0)-(t.budget||0);case"bids_desc":return(t.bid_count||0)-(e.bid_count||0);default:return 0}});const t=10*(ke.value-1),a=t+10;return e.slice(t,a)}),Be=t(()=>{let e=[...ye.value];return Fe.value.status&&(e=e.filter(e=>e.status===Fe.value.status)),Fe.value.category&&(e=e.filter(e=>e.category===Fe.value.category)),Math.ceil(e.length/10)}),Ve=e=>{const t=(e=>e&&Array.isArray(e.attachments)?e.attachments.map(e=>"string"==typeof e?{file_url:e}:e).filter(Boolean):[])(e),a=t.find(e=>{var t;return null==(t=null==e?void 0:e.mime_type)?void 0:t.startsWith("image/")})||t[0];return(null==a?void 0:a.file_url)||null},ze=e=>{const t=Number(e||0);return t>=1e6?`R$ ${(t/1e6).toFixed(1)}M`:t>=1e3?`R$ ${(t/1e3).toFixed(1)}k`:`R$ ${t.toFixed(0)}`},$e=e=>{if(!e)return"Sem prazo";const t=new Date(e);return Number.isNaN(t.getTime())?"Sem prazo":t.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})},Pe=e=>e?e.bid_count??e.bids_count??0:0,Ee=e=>{if(!e)return null;const t=e.lowest_bid_amount??e.lowest_bid??null;return"number"==typeof t?t:t?parseFloat(t):null},Ne=e=>{if(!(null==e?void 0:e.deadline))return null;const t=new Date(e.deadline);if(Number.isNaN(t.getTime()))return null;const a=t-new Date;if(a<=0)return{text:"Prazo encerrado",bgClass:"bg-red-500/90"};const o=Math.floor(a/6e4),r=Math.floor(o/1440),s=Math.floor(o%1440/60),l=o%60;let d="";d=r>0?`${r}d ${s}h`:s>0?`${s}h ${l}m`:`${l}m`;let n="bg-emerald-500/90";return r<=2&&(n="bg-amber-500/90"),s<6&&0===r&&(n="bg-orange-500/90"),0===s&&0===r&&(n="bg-red-500/90"),{text:d,bgClass:n}},Te=e=>{const t=je.find(t=>t.value===e);return t?t.label:e},Le=()=>{Fe.value={status:"",category:"",sortBy:"created_at_desc"},ke.value=1},Re=async()=>{we.value=!0,Ae.value=null;try{const e=await _.getMyProjects();e.success?ye.value=e.data.projects||[]:Ae.value=e.error}catch(e){console.error("Error loading projects:",e),Ae.value="Erro ao carregar projetos"}finally{we.value=!1}},Se=()=>{Re()};return a(()=>[Fe.value.status,Fe.value.category],()=>{ke.value=1}),o(()=>{Re(),"undefined"!=typeof window&&window.addEventListener("kadesh:projects-updated",Se)}),r(()=>{"undefined"!=typeof window&&window.removeEventListener("kadesh:projects-updated",Se)}),(e,t)=>{const a=x("router-link");return f(),s("div",F,[l("div",j,[t[33]||(t[33]=l("div",{class:"mb-8"},[l("h1",{class:"text-3xl font-bold text-heading"},"Meus Projetos"),l("p",{class:"mt-2 text-body"},"Gerencie todos os seus projetos publicados")],-1)),l("div",C,[l("div",D,[l("div",M,[t[5]||(t[5]=l("div",{class:"p-3 rounded-full bg-[rgba(212,175,55,0.15)] text-[#D4AF37] mr-4 border border-[#D4AF37]"},[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),l("div",null,[l("p",B,n(Ce.value.total),1),t[4]||(t[4]=l("p",{class:"text-sm text-body"},"Total",-1))])])]),l("div",V,[l("div",z,[t[7]||(t[7]=l("div",{class:"p-3 rounded-full bg-[rgba(212,175,55,0.15)] text-[#D4AF37] mr-4 border border-[#D4AF37]"},[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),l("div",null,[l("p",$,n(Ce.value.open),1),t[6]||(t[6]=l("p",{class:"text-sm text-body"},"Abertos",-1))])])]),l("div",P,[l("div",E,[t[9]||(t[9]=l("div",{class:"p-3 rounded-full bg-[rgba(212,175,55,0.15)] text-[#D4AF37] mr-4 border border-[#D4AF37]"},[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),l("div",null,[l("p",N,n(Ce.value.in_progress),1),t[8]||(t[8]=l("p",{class:"text-sm text-body"},"Em Andamento",-1))])])]),l("div",T,[l("div",L,[t[11]||(t[11]=l("div",{class:"p-3 rounded-full bg-[rgba(212,175,55,0.15)] text-[#D4AF37] mr-4 border border-[#D4AF37]"},[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),l("div",null,[l("p",R,n(Ce.value.completed),1),t[10]||(t[10]=l("p",{class:"text-sm text-body"},"Concluídos",-1))])])])]),l("div",S,[l("div",O,[l("div",null,[t[13]||(t[13]=l("label",{class:"block text-sm font-medium text-body mb-2"},"Status",-1)),i(l("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>Fe.value.status=e),class:"w-full px-3 py-2 border border-[rgba(212,175,55,0.24)] rounded-md bg-[#1A1A1A] text-heading focus:outline-none focus:ring-2 focus:ring-[#D4AF37] focus:border-[#D4AF37]"},[...t[12]||(t[12]=[u('<option value="" data-v-dfcd0a82>Todos</option><option value="open" data-v-dfcd0a82>Aberto</option><option value="in_progress" data-v-dfcd0a82>Em Andamento</option><option value="completed" data-v-dfcd0a82>Concluído</option><option value="cancelled" data-v-dfcd0a82>Cancelado</option>',5)])],512),[[c,Fe.value.status]])]),l("div",null,[t[15]||(t[15]=l("label",{class:"block text-sm font-medium text-body mb-2"},"Categoria",-1)),i(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>Fe.value.category=e),class:"w-full px-3 py-2 border border-[rgba(212,175,55,0.24)] rounded-md bg-[#1A1A1A] text-heading focus:outline-none focus:ring-2 focus:ring-[#D4AF37] focus:border-[#D4AF37]"},[t[14]||(t[14]=l("option",{value:""},"Todas",-1)),(f(!0),s(b,null,p(g(je),e=>(f(),s("option",{key:e.value,value:e.value},n(e.label),9,H))),128))],512),[[c,Fe.value.category]])]),l("div",null,[t[17]||(t[17]=l("label",{class:"block text-sm font-medium text-body mb-2"},"Ordenar Por",-1)),i(l("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>Fe.value.sortBy=e),class:"w-full px-3 py-2 border border-[rgba(212,175,55,0.24)] rounded-md bg-[#1A1A1A] text-heading focus:outline-none focus:ring-2 focus:ring-[#D4AF37] focus:border-[#D4AF37]"},[...t[16]||(t[16]=[u('<option value="created_at_desc" data-v-dfcd0a82>Mais Recentes</option><option value="created_at_asc" data-v-dfcd0a82>Mais Antigos</option><option value="budget_desc" data-v-dfcd0a82>Maior Orçamento</option><option value="budget_asc" data-v-dfcd0a82>Menor Orçamento</option><option value="bids_desc" data-v-dfcd0a82>Mais Propostas</option>',5)])],512),[[c,Fe.value.sortBy]])])]),De.value?(f(),s("div",U,[l("button",{onClick:Le,class:"text-sm text-[#D4AF37] hover:text-[#E5C04A] font-medium"}," Limpar Filtros ")])):d("",!0)]),we.value?(f(),s("div",q,[...t[18]||(t[18]=[l("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#D4AF37]"},null,-1),l("p",{class:"mt-4 text-body"},"Carregando projetos...",-1)])])):Ae.value?(f(),s("div",G,[t[19]||(t[19]=l("svg",{class:"mx-auto h-12 w-12 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[20]||(t[20]=l("h3",{class:"mt-4 text-lg font-medium text-heading"},"Erro ao carregar projetos",-1)),l("p",I,n(Ae.value),1),l("button",{onClick:Re,class:"mt-6 px-4 py-2 bg-[#D4AF37] text-[#0F1117] font-semibold rounded-md hover:bg-[#E5C04A]"}," Tentar Novamente ")])):0===Me.value.length?(f(),s("div",J,[t[22]||(t[22]=l("svg",{class:"mx-auto h-12 w-12 text-[#D4AF37]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t[23]||(t[23]=l("h3",{class:"mt-4 text-lg font-medium text-heading"},"Nenhum projeto encontrado",-1)),l("p",K,n(De.value?"Tente ajustar os filtros para ver mais resultados.":"Você ainda não criou nenhum projeto."),1),l("div",W,[v(a,{to:"/projects/create",class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700"},{default:m(()=>[...t[21]||(t[21]=[h(" Criar Novo Projeto ",-1)])]),_:1})])])):(f(),s("div",Q,[l("div",X,[(f(!0),s(b,null,p(Me.value,e=>{return f(),s("div",{key:e.id,class:"auction-card-modern group"},[l("div",Y,[Ve(e)?(f(),s("img",{key:0,src:Ve(e),alt:e.title,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"},null,8,Z)):(f(),s("div",ee,[...t[24]||(t[24]=[l("svg",{class:"w-20 h-20 text-[#D4AF37]/30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])])),t[26]||(t[26]=l("div",{class:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"},null,-1)),l("div",te,[l("span",{class:y(["px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wide backdrop-blur-sm","open"===e.status?"bg-emerald-500/90 text-white":"in_progress"===e.status?"bg-amber-500/90 text-white":"bg-gray-500/90 text-white"])},n((o=e.status,{open:"Aberto",in_progress:"Em andamento",completed:"Concluido",cancelled:"Cancelado"}[o]||o)),3)]),Ne(e)?(f(),s("div",ae,[l("div",{class:y(["flex items-center gap-2 px-3 py-1.5 rounded-full backdrop-blur-sm text-white font-bold text-sm",Ne(e).bgClass])},[t[25]||(t[25]=l("svg",{class:"w-4 h-4 animate-pulse",fill:"currentColor",viewBox:"0 0 20 20"},[l("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1)),h(" "+n(Ne(e).text),1)],2)])):d("",!0)]),l("div",oe,[l("span",re,n(Te(e.category)),1),l("p",se,[t[27]||(t[27]=h(" Contratante: ",-1)),l("span",le,n(_e.value),1)]),v(a,{to:`/projects/${e.id}`,class:"block text-lg font-bold text-[#F5F5F5] hover:text-[#D4AF37] transition-colors line-clamp-2 mb-3 leading-tight"},{default:m(()=>[h(n(e.title),1)]),_:2},1032,["to"]),l("p",de,n(e.description),1),l("div",ne,[l("div",ie,[t[28]||(t[28]=l("p",{class:"text-xs text-[#8A8A8A] uppercase mb-1"},"Orcamento",-1)),l("p",ce,n(ze(e.budget||e.max_budget)),1)]),l("div",ue,[t[29]||(t[29]=l("p",{class:"text-xs text-[#8A8A8A] uppercase mb-1"},"Prazo",-1)),l("p",be,n($e(e.deadline)),1)]),l("div",pe,[t[30]||(t[30]=l("p",{class:"text-xs text-[#8A8A8A] uppercase mb-1"},"Propostas",-1)),l("p",ge,n(Pe(e)),1)]),l("div",ve,[t[31]||(t[31]=l("p",{class:"text-xs text-[#8A8A8A] uppercase mb-1"},"Menor",-1)),l("p",{class:y(["text-base font-bold",Ee(e)?"text-emerald-400":"text-[#8A8A8A]"])},n(Ee(e)?ze(Ee(e)):"—"),3)])]),l("div",me,[v(a,{to:`/projects/${e.id}`,class:"cta-view"},{default:m(()=>[...t[32]||(t[32]=[h(" Ver Detalhes ",-1)])]),_:1},8,["to"]),"open"===e.status?(f(),s("button",xe," Ver Propostas ("+n(Pe(e))+") ",1)):d("",!0)])])]);var o}),128))])])),Be.value>1?(f(),s("div",fe,[v(k,{"current-page":ke.value,"total-pages":Be.value,onPageChanged:t[3]||(t[3]=e=>ke.value=e)},null,8,["current-page","total-pages"])])):d("",!0)])])}}},[["__scopeId","data-v-dfcd0a82"]]);export{he as default};
