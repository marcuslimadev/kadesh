import{r as e,c as t,A as a,o as s,a as r,e as o,i as l,t as n,B as d,J as i,q as c,F as u,l as p,f as m,h as v,j as g,g as b,b as x,p as f}from"./vue-_iW_wwAQ.js";import{u as h}from"./index-D2aUnrON.js";import{_ as y}from"./StatusBadge-DFy4JmzA.js";import{_ as w}from"./Pagination-BYJXTjY_.js";import{b as k}from"./bidService-Bm0ssxEY.js";import{p as j}from"./projectService-BF-JjfR9.js";import{b as C}from"./utils-CeLII1lI.js";import{l as F}from"./index-Ctu0mvSg.js";const _={class:"min-h-screen bg-page py-8"},A={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},B={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},D={class:"bg-[#161821] rounded-lg shadow-lg p-6 border border-[rgba(212,175,55,0.24)]"},M={class:"flex items-center"},V={class:"text-2xl font-bold text-[#F5F5F5]"},z={class:"bg-[#161821] rounded-lg shadow-lg p-6 border border-[rgba(212,175,55,0.24)]"},P={class:"flex items-center"},E={class:"text-2xl font-bold text-[#F5F5F5]"},R={class:"bg-[#161821] rounded-lg shadow-lg p-6 border border-[rgba(212,175,55,0.24)]"},S={class:"flex items-center"},T={class:"text-2xl font-bold text-[#F5F5F5]"},H={class:"bg-[#161821] rounded-lg shadow-lg p-6 border border-[rgba(212,175,55,0.24)]"},L={class:"flex items-center"},N={class:"text-2xl font-bold text-[#F5F5F5]"},U={class:"bg-[#161821] rounded-lg shadow-lg p-6 mb-6 border border-[rgba(212,175,55,0.24)]"},q={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},O=["value"],I={key:0,class:"mt-4"},J={key:0,class:"text-center py-12"},$={key:1,class:"bg-surface rounded-lg shadow p-8 text-center"},G={class:"mt-2 text-sm text-body"},K={key:2,class:"bg-surface rounded-lg shadow p-12 text-center"},Q={class:"mt-2 text-sm text-body"},W={class:"mt-6"},X={key:3,class:"space-y-4"},Y={class:"p-6"},Z={class:"flex items-start justify-between mb-4"},ee={class:"flex-1"},te={class:"flex items-center gap-3 mb-2"},ae={class:"text-xl font-semibold text-heading"},se={class:"text-sm text-gray-500 mb-3"},re={class:"text-right"},oe={class:"text-2xl font-bold text-heading"},le={class:"bg-gray-50 rounded-lg p-4 mb-4"},ne={class:"text-sm text-body"},de={class:"flex items-center gap-6 text-sm text-gray-500 mb-4"},ie={class:"flex items-center"},ce={class:"flex items-center"},ue={key:0,class:"flex items-center"},pe={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200"},me=["onClick"],ve={key:4,class:"mt-8"},ge={__name:"MyBids",setup(ge){h();const be=e([]),xe=e(!1),fe=e(null),he=e(1),ye=e({status:"",category:"",sortBy:"created_at_desc"}),we=j.getCategories(),ke=t(()=>({total:be.value.length,pending:be.value.filter(e=>"pending"===e.status).length,accepted:be.value.filter(e=>"accepted"===e.status).length,rejected:be.value.filter(e=>"rejected"===e.status).length})),je=t(()=>""!==ye.value.status||""!==ye.value.category),Ce=t(()=>{let e=[...be.value];ye.value.status&&(e=e.filter(e=>e.status===ye.value.status)),ye.value.category&&(e=e.filter(e=>e.project_category===ye.value.category)),e.sort((e,t)=>{switch(ye.value.sortBy){case"created_at_desc":return new Date(t.created_at)-new Date(e.created_at);case"created_at_asc":return new Date(e.created_at)-new Date(t.created_at);case"amount_desc":return(t.amount||0)-(e.amount||0);case"amount_asc":return(e.amount||0)-(t.amount||0);default:return 0}});const t=10*(he.value-1),a=t+10;return e.slice(t,a)}),Fe=t(()=>{let e=[...be.value];return ye.value.status&&(e=e.filter(e=>e.status===ye.value.status)),ye.value.category&&(e=e.filter(e=>e.project_category===ye.value.category)),Math.ceil(e.length/10)}),_e=e=>{if(!e)return"Data não disponível";try{return C(new Date(e),{addSuffix:!0,locale:F})}catch(t){return"Data inválida"}},Ae=e=>e||0===e?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e):"A combinar",Be=e=>{const t=we.find(t=>t.value===e);return t?t.label:e},De=()=>{ye.value={status:"",category:"",sortBy:"created_at_desc"},he.value=1},Me=async()=>{xe.value=!0,fe.value=null;try{const e=await k.getMyBids();e.success?be.value=e.data.bids||[]:fe.value=e.error}catch(e){console.error("Error loading bids:",e),fe.value="Erro ao carregar propostas"}finally{xe.value=!1}};return a(()=>[ye.value.status,ye.value.category],()=>{he.value=1}),s(()=>{Me()}),(e,t)=>{const a=b("router-link");return x(),r("div",_,[o("div",A,[t[29]||(t[29]=o("div",{class:"mb-8"},[o("h1",{class:"text-3xl font-bold text-heading"},"Minhas Propostas"),o("p",{class:"mt-2 text-body"},"Acompanhe todas as suas propostas enviadas")],-1)),o("div",B,[o("div",D,[o("div",M,[t[5]||(t[5]=o("div",{class:"p-3 rounded-full bg-[rgba(212,175,55,0.15)] text-[#D4AF37] mr-4 border border-[#D4AF37]"},[o("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),o("div",null,[o("p",V,n(ke.value.total),1),t[4]||(t[4]=o("p",{class:"text-sm text-[#C7C7C7]"},"Total",-1))])])]),o("div",z,[o("div",P,[t[7]||(t[7]=o("div",{class:"p-3 rounded-full bg-[rgba(212,175,55,0.15)] text-[#D4AF37] mr-4 border border-[#D4AF37]"},[o("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),o("div",null,[o("p",E,n(ke.value.pending),1),t[6]||(t[6]=o("p",{class:"text-sm text-[#C7C7C7]"},"Pendentes",-1))])])]),o("div",R,[o("div",S,[t[9]||(t[9]=o("div",{class:"p-3 rounded-full bg-[rgba(212,175,55,0.15)] text-[#D4AF37] mr-4 border border-[#D4AF37]"},[o("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),o("div",null,[o("p",T,n(ke.value.accepted),1),t[8]||(t[8]=o("p",{class:"text-sm text-[#C7C7C7]"},"Aceitas",-1))])])]),o("div",H,[o("div",L,[t[11]||(t[11]=o("div",{class:"p-3 rounded-full bg-[rgba(212,175,55,0.15)] text-[#D4AF37] mr-4 border border-[#D4AF37]"},[o("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),o("div",null,[o("p",N,n(ke.value.rejected),1),t[10]||(t[10]=o("p",{class:"text-sm text-[#C7C7C7]"},"Rejeitadas",-1))])])])]),o("div",U,[o("div",q,[o("div",null,[t[13]||(t[13]=o("label",{class:"block text-sm font-medium text-[#C7C7C7] mb-2"},"Status",-1)),d(o("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>ye.value.status=e),class:"w-full px-3 py-2 border border-[rgba(212,175,55,0.24)] rounded-md bg-[#1A1A1A] text-[#F5F5F5] focus:outline-none focus:ring-2 focus:ring-[#D4AF37] focus:border-[#D4AF37]"},[...t[12]||(t[12]=[c('<option value="">Todos</option><option value="pending">Pendente</option><option value="accepted">Aceita</option><option value="rejected">Rejeitada</option><option value="withdrawn">Retirada</option>',5)])],512),[[i,ye.value.status]])]),o("div",null,[t[15]||(t[15]=o("label",{class:"block text-sm font-medium text-[#C7C7C7] mb-2"},"Categoria",-1)),d(o("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>ye.value.category=e),class:"w-full px-3 py-2 border border-[rgba(212,175,55,0.24)] rounded-md bg-[#1A1A1A] text-[#F5F5F5] focus:outline-none focus:ring-2 focus:ring-[#D4AF37] focus:border-[#D4AF37]"},[t[14]||(t[14]=o("option",{value:""},"Todas",-1)),(x(!0),r(u,null,p(m(we),e=>(x(),r("option",{key:e.value,value:e.value},n(e.label),9,O))),128))],512),[[i,ye.value.category]])]),o("div",null,[t[17]||(t[17]=o("label",{class:"block text-sm font-medium text-[#C7C7C7] mb-2"},"Ordenar Por",-1)),d(o("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>ye.value.sortBy=e),class:"w-full px-3 py-2 border border-[rgba(212,175,55,0.24)] rounded-md bg-[#1A1A1A] text-[#F5F5F5] focus:outline-none focus:ring-2 focus:ring-[#D4AF37] focus:border-[#D4AF37]"},[...t[16]||(t[16]=[o("option",{value:"created_at_desc"},"Mais Recentes",-1),o("option",{value:"created_at_asc"},"Mais Antigas",-1),o("option",{value:"amount_desc"},"Maior Valor",-1),o("option",{value:"amount_asc"},"Menor Valor",-1)])],512),[[i,ye.value.sortBy]])])]),je.value?(x(),r("div",I,[o("button",{onClick:De,class:"text-sm text-[#D4AF37] hover:text-[#E5C04A] font-medium"}," Limpar Filtros ")])):l("",!0)]),xe.value?(x(),r("div",J,[...t[18]||(t[18]=[o("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"},null,-1),o("p",{class:"mt-4 text-body"},"Carregando propostas...",-1)])])):fe.value?(x(),r("div",$,[t[19]||(t[19]=o("svg",{class:"mx-auto h-12 w-12 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[20]||(t[20]=o("h3",{class:"mt-4 text-lg font-medium text-heading"},"Erro ao carregar propostas",-1)),o("p",G,n(fe.value),1),o("button",{onClick:Me,class:"mt-6 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700"}," Tentar Novamente ")])):0===Ce.value.length?(x(),r("div",K,[t[22]||(t[22]=o("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t[23]||(t[23]=o("h3",{class:"mt-4 text-lg font-medium text-heading"},"Nenhuma proposta encontrada",-1)),o("p",Q,n(je.value?"Tente ajustar os filtros para ver mais resultados.":"Você ainda não enviou nenhuma proposta."),1),o("div",W,[v(a,{to:"/projects",class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700"},{default:g(()=>[...t[21]||(t[21]=[f(" Explorar Projetos ",-1)])]),_:1})])])):(x(),r("div",X,[(x(!0),r(u,null,p(Ce.value,e=>(x(),r("div",{key:e.id,class:"bg-surface rounded-lg shadow hover:shadow-md transition-shadow"},[o("div",Y,[o("div",Z,[o("div",ee,[o("div",te,[o("h3",ae,n(e.project_title),1),v(y,{status:e.status},null,8,["status"])]),o("p",se,n(Be(e.project_category)),1)]),o("div",re,[o("p",oe,n(Ae(e.amount)),1),t[24]||(t[24]=o("p",{class:"text-sm text-gray-500"},"Sua proposta",-1))])]),o("div",le,[o("p",ne,n(e.description),1)]),o("div",de,[o("span",ie,[t[25]||(t[25]=o("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),f(" "+n(e.delivery_time_days)+" dias de entrega ",1)]),o("span",ce,[t[26]||(t[26]=o("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),f(" Enviada "+n(_e(e.created_at)),1)]),e.project_budget?(x(),r("span",ue,[t[27]||(t[27]=o("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),f(" Orçamento: "+n(Ae(e.project_budget)),1)])):l("",!0)]),o("div",pe,[v(a,{to:`/projects/${e.project_id}`,class:"px-4 py-2 text-sm font-medium text-body bg-surface border border-gray-300 rounded-md hover:bg-gray-50"},{default:g(()=>[...t[28]||(t[28]=[f(" Ver Projeto ",-1)])]),_:1},8,["to"]),"pending"===e.status?(x(),r("button",{key:0,onClick:t=>(async e=>{if(confirm("Tem certeza que deseja retirar esta proposta?"))try{if((await k.withdrawBid(e)).success){const t=be.value.find(t=>t.id===e);t&&(t.status="withdrawn")}}catch(t){console.error("Error withdrawing bid:",t)}})(e.id),class:"px-4 py-2 text-sm font-medium text-red-700 bg-surface border border-red-300 rounded-md hover:bg-red-50"}," Retirar Proposta ",8,me)):l("",!0)])])]))),128))])),Fe.value>1?(x(),r("div",ve,[v(w,{"current-page":he.value,"total-pages":Fe.value,onPageChanged:t[3]||(t[3]=e=>he.value=e)},null,8,["current-page","total-pages"])])):l("",!0)])])}}};export{ge as default};
